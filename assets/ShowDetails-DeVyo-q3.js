import{l as w,m as S,r as c,n as j,K as yt,a6 as V,a7 as X,a8 as bt,o as D,q as C,j as e,t as f,v as k,s as x,a9 as Dt,aa as vt,y as q,T as P,x as wt,k as J,d as W,ab as St,M as jt,G as L,I as kt,O as Mt,A as G,L as Tt,S as E,a1 as Pt,a2 as Wt,c as It}from"./index-DC03GztF.js";import{a as v}from"./index-Btov1xSy.js";import{S as K}from"./SubCard-DRLMpSF2.js";import{A as At}from"./Accordion-BqeaWFg1.js";import{C as Rt}from"./CustomFormControl-B31ajR66.js";import{M as $t}from"./MenuItem-pbFqvMfG.js";function Ft(t){return w("MuiDialog",t)}const H=S("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),Q=c.createContext({}),Bt=x(vt,{name:"MuiDialog",slot:"Backdrop",overrides:(t,o)=>o.backdrop})({zIndex:-1}),Nt=t=>{const{classes:o,scroll:s,maxWidth:r,fullWidth:l,fullScreen:i}=t,p={root:["root"],container:["container",`scroll${f(s)}`],paper:["paper",`paperScroll${f(s)}`,`paperWidth${f(String(r))}`,l&&"paperFullWidth",i&&"paperFullScreen"]};return k(p,Ft,o)},Ut=x(Dt,{name:"MuiDialog",slot:"Root"})({"@media print":{position:"absolute !important"}}),zt=x("div",{name:"MuiDialog",slot:"Container",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.container,o[`scroll${f(s.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),Lt=x(V,{name:"MuiDialog",slot:"Paper",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.paper,o[`scrollPaper${f(s.scroll)}`],o[`paperWidth${f(String(s.maxWidth))}`],s.fullWidth&&o.paperFullWidth,s.fullScreen&&o.paperFullScreen]}})(q(({theme:t})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:o})=>!o.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:t.breakpoints.unit==="px"?Math.max(t.breakpoints.values.xs,444):`max(${t.breakpoints.values.xs}${t.breakpoints.unit}, 444px)`,[`&.${H.paperScrollBody}`]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(t.breakpoints.values).filter(o=>o!=="xs").map(o=>({props:{maxWidth:o},style:{maxWidth:`${t.breakpoints.values[o]}${t.breakpoints.unit}`,[`&.${H.paperScrollBody}`]:{[t.breakpoints.down(t.breakpoints.values[o]+64)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:o})=>o.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:o})=>o.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${H.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),Et=c.forwardRef(function(o,s){const r=j({props:o,name:"MuiDialog"}),l=yt(),i={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{"aria-describedby":p,"aria-labelledby":d,"aria-modal":u=!0,BackdropComponent:g,BackdropProps:M,children:I,className:A,disableEscapeKeyDown:T=!1,fullScreen:R=!1,fullWidth:$=!1,maxWidth:F="sm",onClick:a,onClose:n,open:h,PaperComponent:B=V,PaperProps:O={},scroll:Z="paper",slots:_={},slotProps:tt={},TransitionComponent:ot=X,transitionDuration:Y=i,TransitionProps:et,...st}=r,m={...r,disableEscapeKeyDown:T,fullScreen:R,fullWidth:$,maxWidth:F,scroll:Z},N=Nt(m),U=c.useRef(),at=b=>{U.current=b.target===b.currentTarget},rt=b=>{a&&a(b),U.current&&(U.current=null,n&&n(b,"backdropClick"))},z=bt(d),nt=c.useMemo(()=>({titleId:z}),[z]),it={transition:ot,..._},lt={transition:et,paper:O,backdrop:M,...tt},y={slots:it,slotProps:lt},[ct,pt]=D("root",{elementType:Ut,shouldForwardComponentProp:!0,externalForwardedProps:y,ownerState:m,className:C(N.root,A),ref:s}),[dt,ut]=D("backdrop",{elementType:Bt,shouldForwardComponentProp:!0,externalForwardedProps:y,ownerState:m}),[gt,ht]=D("paper",{elementType:Lt,shouldForwardComponentProp:!0,externalForwardedProps:y,ownerState:m,className:C(N.paper,O.className)}),[xt,mt]=D("container",{elementType:zt,externalForwardedProps:y,ownerState:m,className:N.container}),[ft,Ct]=D("transition",{elementType:X,externalForwardedProps:y,ownerState:m,additionalProps:{appear:!0,in:h,timeout:Y,role:"presentation"}});return e.jsx(ct,{closeAfterTransition:!0,slots:{backdrop:dt},slotProps:{backdrop:{transitionDuration:Y,as:g,...ut}},disableEscapeKeyDown:T,onClose:n,open:h,onClick:rt,...pt,...st,children:e.jsx(ft,{...Ct,children:e.jsx(xt,{onMouseDown:at,...mt,children:e.jsx(gt,{as:B,elevation:24,role:"dialog","aria-describedby":p,"aria-labelledby":z,"aria-modal":u,...ht,children:e.jsx(Q.Provider,{value:nt,children:I})})})})})});function Ht(t){return w("MuiDialogActions",t)}S("MuiDialogActions",["root","spacing"]);const Ot=t=>{const{classes:o,disableSpacing:s}=t;return k({root:["root",!s&&"spacing"]},Ht,o)},Yt=x("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.root,!s.disableSpacing&&o.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:t})=>!t.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),Xt=c.forwardRef(function(o,s){const r=j({props:o,name:"MuiDialogActions"}),{className:l,disableSpacing:i=!1,...p}=r,d={...r,disableSpacing:i},u=Ot(d);return e.jsx(Yt,{className:C(u.root,l),ownerState:d,ref:s,...p})});function Gt(t){return w("MuiDialogContent",t)}S("MuiDialogContent",["root","dividers"]);function Kt(t){return w("MuiDialogTitle",t)}const Vt=S("MuiDialogTitle",["root"]),qt=t=>{const{classes:o,dividers:s}=t;return k({root:["root",s&&"dividers"]},Gt,o)},Jt=x("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:s}=t;return[o.root,s.dividers&&o.dividers]}})(q(({theme:t})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:o})=>o.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(t.vars||t).palette.divider}`,borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:o})=>!o.dividers,style:{[`.${Vt.root} + &`]:{paddingTop:0}}}]}))),Qt=c.forwardRef(function(o,s){const r=j({props:o,name:"MuiDialogContent"}),{className:l,dividers:i=!1,...p}=r,d={...r,dividers:i},u=qt(d);return e.jsx(Jt,{className:C(u.root,l),ownerState:d,ref:s,...p})});function Zt(t){return w("MuiDialogContentText",t)}S("MuiDialogContentText",["root"]);const _t=t=>{const{classes:o}=t,r=k({root:["root"]},Zt,o);return{...o,...r}},to=x(P,{shouldForwardProp:t=>wt(t)||t==="classes",name:"MuiDialogContentText",slot:"Root"})({}),oo=c.forwardRef(function(o,s){const r=j({props:o,name:"MuiDialogContentText"}),{children:l,className:i,...p}=r,d=_t(p);return e.jsx(to,{component:"p",variant:"body1",color:"textSecondary",ref:s,ownerState:p,className:C(d.root,i),...r,classes:d})}),eo=t=>{const{classes:o}=t;return k({root:["root"]},Kt,o)},so=x(P,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),ao=c.forwardRef(function(o,s){const r=j({props:o,name:"MuiDialogTitle"}),{className:l,id:i,...p}=r,d=r,u=eo(d),{titleId:g=i}=c.useContext(Q);return e.jsx(so,{component:"h2",className:C(u.root,l),ownerState:d,ref:s,variant:"h6",id:i??g,...p})}),ro=J(e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),no=J(e.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"})),io=({open:t,handleClose:o,handleConfirm:s,title:r,description:l})=>e.jsxs(Et,{open:t,onClose:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(ao,{id:"alert-dialog-title",children:r}),e.jsx(Qt,{children:e.jsx(oo,{id:"alert-dialog-description",children:l})}),e.jsxs(Xt,{children:[e.jsx(W,{onClick:o,color:"primary",children:"Cancel"}),e.jsx(W,{onClick:s,color:"error",autoFocus:!0,children:"Delete"})]})]});function mo(){const{id:t}=St(),[o,s]=c.useState([]),[r,l]=c.useState(""),[i,p]=c.useState(""),[d,u]=c.useState([]),g=c.useCallback(async()=>{try{const a=await v.get(`https://glagoltheatre.ru/api/shows/${t}`);s(a.data)}catch(a){console.log(a)}},[]);c.useEffect(()=>{g()},[g]);const M=c.useCallback(async()=>{try{const a=await v.get("https://glagoltheatre.ru/api/user/actors");u(a.data)}catch(a){console.log(a)}},[]);c.useEffect(()=>{M()},[M]);const I=async a=>{if(console.log("Deleting item with id:",a.characterID,a.personID),!a)return;const n=`https://www.glagoltheatre.ru/api/shows/performer/${a.characterID}/${a.personID}`,h=await v.delete(n,{headers:{"Content-Type":"application/json; charset=UTF-8"}});console.log(h.data),g()},A=a=>e.jsxs(E,{spacing:2,children:[e.jsxs(E,{direction:{xs:"column",sm:"row"},spacing:2,sx:{alignItems:"center",justifyContent:"left"},children:[e.jsx(Pt,{id:"standard-select-currency",select:!0,value:i,sx:{minWidth:200},onChange:n=>p(n.target.value),children:d.map(n=>e.jsx($t,{value:n.personID,children:n.name},n.personID))}),e.jsx(G,{children:e.jsx(W,{disableElevation:!0,fullWidth:!0,size:"medium",type:"button",variant:"contained",color:"primary",onClick:n=>$(n,a.id),children:"Добавить исполнителя"})})]}),e.jsx(K,{title:"Исполнители",children:a.performers.map(n=>e.jsxs(E,{direction:"row",sx:{alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(P,{variant:"body2",sx:{color:"inherit"},children:[" ",n.name]}),e.jsx(lo,{item:n,onDelete:I})]}))})]},a.id),T=()=>o.characters?o.characters.map(a=>({title:a.name,id:a.id,content:A(a)})):[],R=async a=>{if(a.preventDefault(),!r)return;const n={showId:t,name:r},h=await v.post("https://glagoltheatre.ru/api/shows/character",n);console.log(h.data),l(""),g()},$=async(a,n)=>{if(a.preventDefault(),console.log(i+" "+n),!i)return;const h={personID:i,characterID:n},B=await v.post("https://glagoltheatre.ru/api/shows/performer",h);console.log(B.data),p(""),g()},F=e.jsx(Tt,{to:"/shows",children:e.jsx(no,{})});return e.jsxs(jt,{title:o.name,secondary:F,children:[e.jsx(P,{variant:"body2"}),e.jsxs(K,{title:"Роли",children:[e.jsxs(L,{container:!0,spacing:{xs:0,sm:2},alignItems:"center",children:[e.jsx(L,{size:{xs:12,sm:9},children:e.jsxs(Rt,{fullWidth:!0,children:[e.jsx(kt,{htmlFor:"txt-character",children:"Новая роль"}),e.jsx(Mt,{id:"txt-character",type:"text",name:"txtCharacter",value:r,onChange:a=>l(a.target.value)})]})}),e.jsx(L,{size:{xs:12,sm:3},children:e.jsx(G,{children:e.jsx(W,{disableElevation:!0,fullWidth:!0,size:"large",type:"button",variant:"contained",color:"secondary",onClick:R,children:"Добавить"})})})]}),e.jsx(At,{data:T(),toggle:!0})]})]})}const lo=({item:t,onDelete:o})=>{const[s,r]=c.useState(!1),l=()=>{r(!0)},i=()=>{r(!1)},p=()=>{o(t),i()};return e.jsxs(e.Fragment,{children:[e.jsx(Wt,{title:"Удалить",children:e.jsx(It,{"aria-label":"delete",onClick:l,children:e.jsx(ro,{})})}),e.jsx(io,{open:s,handleClose:i,handleConfirm:p,title:"Подтверждение удаления",description:"Точно удалить?"})]})};export{mo as default};
