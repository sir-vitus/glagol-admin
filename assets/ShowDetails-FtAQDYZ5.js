import{h as Ct,j as o,i as S,k as w,r as c,l as j,H as yt,a3 as V,a4 as Y,a5 as bt,m as D,o as C,p as f,q as k,s as h,a6 as Dt,a7 as vt,w as q,T as W,v as St,c as I,a8 as wt,M as jt,G as z,I as kt,O as Mt,A as X,S as E,$ as Tt,a1 as Pt,b as Wt}from"./index-CC7ZbzGT.js";import{a as v}from"./index-Btov1xSy.js";import{S as G}from"./SubCard-MJ0Jb-Vn.js";import{A as It}from"./Accordion-2uBZicj3.js";import{C as $t}from"./CustomFormControl-Cc3T7dmO.js";import{M as Rt}from"./MenuItem-B2C3lAD7.js";const At=Ct(o.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}));function Ft(t){return S("MuiDialog",t)}const O=w("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),K=c.createContext({}),Bt=h(vt,{name:"MuiDialog",slot:"Backdrop",overrides:(t,e)=>e.backdrop})({zIndex:-1}),Nt=t=>{const{classes:e,scroll:s,maxWidth:a,fullWidth:l,fullScreen:n}=t,p={root:["root"],container:["container",`scroll${f(s)}`],paper:["paper",`paperScroll${f(s)}`,`paperWidth${f(String(a))}`,l&&"paperFullWidth",n&&"paperFullScreen"]};return k(p,Ft,e)},Ut=h(Dt,{name:"MuiDialog",slot:"Root"})({"@media print":{position:"absolute !important"}}),zt=h("div",{name:"MuiDialog",slot:"Container",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[e.container,e[`scroll${f(s.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),Et=h(V,{name:"MuiDialog",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[e.paper,e[`scrollPaper${f(s.scroll)}`],e[`paperWidth${f(String(s.maxWidth))}`],s.fullWidth&&e.paperFullWidth,s.fullScreen&&e.paperFullScreen]}})(q(({theme:t})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:e})=>!e.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:t.breakpoints.unit==="px"?Math.max(t.breakpoints.values.xs,444):`max(${t.breakpoints.values.xs}${t.breakpoints.unit}, 444px)`,[`&.${O.paperScrollBody}`]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(t.breakpoints.values).filter(e=>e!=="xs").map(e=>({props:{maxWidth:e},style:{maxWidth:`${t.breakpoints.values[e]}${t.breakpoints.unit}`,[`&.${O.paperScrollBody}`]:{[t.breakpoints.down(t.breakpoints.values[e]+64)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:e})=>e.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:e})=>e.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${O.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),Ot=c.forwardRef(function(e,s){const a=j({props:e,name:"MuiDialog"}),l=yt(),n={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{"aria-describedby":p,"aria-labelledby":d,"aria-modal":u=!0,BackdropComponent:g,BackdropProps:M,children:$,className:R,disableEscapeKeyDown:T=!1,fullScreen:A=!1,fullWidth:F=!1,maxWidth:r="sm",onClick:i,onClose:x,open:P,PaperComponent:J=V,PaperProps:H={},scroll:Q="paper",slots:Z={},slotProps:_={},TransitionComponent:tt=Y,transitionDuration:L=n,TransitionProps:et,...ot}=a,m={...a,disableEscapeKeyDown:T,fullScreen:A,fullWidth:F,maxWidth:r,scroll:Q},B=Nt(m),N=c.useRef(),st=b=>{N.current=b.target===b.currentTarget},at=b=>{i&&i(b),N.current&&(N.current=null,x&&x(b,"backdropClick"))},U=bt(d),rt=c.useMemo(()=>({titleId:U}),[U]),nt={transition:tt,...Z},it={transition:et,paper:H,backdrop:M,..._},y={slots:nt,slotProps:it},[lt,ct]=D("root",{elementType:Ut,shouldForwardComponentProp:!0,externalForwardedProps:y,ownerState:m,className:C(B.root,R),ref:s}),[pt,dt]=D("backdrop",{elementType:Bt,shouldForwardComponentProp:!0,externalForwardedProps:y,ownerState:m}),[ut,gt]=D("paper",{elementType:Et,shouldForwardComponentProp:!0,externalForwardedProps:y,ownerState:m,className:C(B.paper,H.className)}),[ht,xt]=D("container",{elementType:zt,externalForwardedProps:y,ownerState:m,className:B.container}),[mt,ft]=D("transition",{elementType:Y,externalForwardedProps:y,ownerState:m,additionalProps:{appear:!0,in:P,timeout:L,role:"presentation"}});return o.jsx(lt,{closeAfterTransition:!0,slots:{backdrop:pt},slotProps:{backdrop:{transitionDuration:L,as:g,...dt}},disableEscapeKeyDown:T,onClose:x,open:P,onClick:at,...ct,...ot,children:o.jsx(mt,{...ft,children:o.jsx(ht,{onMouseDown:st,...xt,children:o.jsx(ut,{as:J,elevation:24,role:"dialog","aria-describedby":p,"aria-labelledby":U,"aria-modal":u,...gt,children:o.jsx(K.Provider,{value:rt,children:$})})})})})});function Ht(t){return S("MuiDialogActions",t)}w("MuiDialogActions",["root","spacing"]);const Lt=t=>{const{classes:e,disableSpacing:s}=t;return k({root:["root",!s&&"spacing"]},Ht,e)},Yt=h("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[e.root,!s.disableSpacing&&e.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:t})=>!t.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),Xt=c.forwardRef(function(e,s){const a=j({props:e,name:"MuiDialogActions"}),{className:l,disableSpacing:n=!1,...p}=a,d={...a,disableSpacing:n},u=Lt(d);return o.jsx(Yt,{className:C(u.root,l),ownerState:d,ref:s,...p})});function Gt(t){return S("MuiDialogContent",t)}w("MuiDialogContent",["root","dividers"]);function Vt(t){return S("MuiDialogTitle",t)}const qt=w("MuiDialogTitle",["root"]),Kt=t=>{const{classes:e,dividers:s}=t;return k({root:["root",s&&"dividers"]},Gt,e)},Jt=h("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[e.root,s.dividers&&e.dividers]}})(q(({theme:t})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:e})=>e.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(t.vars||t).palette.divider}`,borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>!e.dividers,style:{[`.${qt.root} + &`]:{paddingTop:0}}}]}))),Qt=c.forwardRef(function(e,s){const a=j({props:e,name:"MuiDialogContent"}),{className:l,dividers:n=!1,...p}=a,d={...a,dividers:n},u=Kt(d);return o.jsx(Jt,{className:C(u.root,l),ownerState:d,ref:s,...p})});function Zt(t){return S("MuiDialogContentText",t)}w("MuiDialogContentText",["root"]);const _t=t=>{const{classes:e}=t,a=k({root:["root"]},Zt,e);return{...e,...a}},te=h(W,{shouldForwardProp:t=>St(t)||t==="classes",name:"MuiDialogContentText",slot:"Root"})({}),ee=c.forwardRef(function(e,s){const a=j({props:e,name:"MuiDialogContentText"}),{children:l,className:n,...p}=a,d=_t(p);return o.jsx(te,{component:"p",variant:"body1",color:"textSecondary",ref:s,ownerState:p,className:C(d.root,n),...a,classes:d})}),oe=t=>{const{classes:e}=t;return k({root:["root"]},Vt,e)},se=h(W,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),ae=c.forwardRef(function(e,s){const a=j({props:e,name:"MuiDialogTitle"}),{className:l,id:n,...p}=a,d=a,u=oe(d),{titleId:g=n}=c.useContext(K);return o.jsx(se,{component:"h2",className:C(u.root,l),ownerState:d,ref:s,variant:"h6",id:n??g,...p})}),re=({open:t,handleClose:e,handleConfirm:s,title:a,description:l})=>o.jsxs(Ot,{open:t,onClose:e,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[o.jsx(ae,{id:"alert-dialog-title",children:a}),o.jsx(Qt,{children:o.jsx(ee,{id:"alert-dialog-description",children:l})}),o.jsxs(Xt,{children:[o.jsx(I,{onClick:e,color:"primary",children:"Cancel"}),o.jsx(I,{onClick:s,color:"error",autoFocus:!0,children:"Delete"})]})]});function ge(){const{id:t}=wt(),[e,s]=c.useState([]),[a,l]=c.useState(""),[n,p]=c.useState(""),[d,u]=c.useState([]),g=c.useCallback(async()=>{try{const r=await v.get(`https://glagoltheatre.ru/api/shows/${t}`);s(r.data)}catch(r){console.log(r)}},[]);c.useEffect(()=>{g()},[g]);const M=c.useCallback(async()=>{try{const r=await v.get("https://glagoltheatre.ru/api/user/actors");u(r.data)}catch(r){console.log(r)}},[]);c.useEffect(()=>{M()},[M]);const $=async r=>{if(console.log("Deleting item with id:",r.characterID,r.personID),!r)return;const i=await v.delete(`https://glagoltheatre.ru/api/shows/performer/${r.characterID}/${r.personID}`);console.log(i.data),g()},R=r=>o.jsxs(E,{spacing:2,children:[o.jsxs(E,{direction:{xs:"column",sm:"row"},spacing:2,sx:{alignItems:"center",justifyContent:"left"},children:[o.jsx(Tt,{id:"standard-select-currency",select:!0,value:n,sx:{minWidth:200},onChange:i=>p(i.target.value),children:d.map(i=>o.jsx(Rt,{value:i.personID,children:i.name},i.personID))}),o.jsx(X,{children:o.jsx(I,{disableElevation:!0,fullWidth:!0,size:"medium",type:"button",variant:"contained",color:"primary",onClick:i=>F(i,r.id),children:"Добавить исполнителя"})})]}),o.jsx(G,{title:"Исполнители",children:r.performers.map(i=>o.jsxs(E,{direction:"row",sx:{alignItems:"center",justifyContent:"space-between"},children:[o.jsxs(W,{variant:"subtitle1",sx:{color:"inherit"},children:[" ",i.name]}),o.jsx(ne,{item:i,onDelete:$})]}))})]},r.id),T=()=>e.characters?e.characters.map(r=>({title:r.name,id:r.id,content:R(r)})):[],A=async r=>{if(r.preventDefault(),!a)return;const i={showId:t,name:a},x=await v.post("https://glagoltheatre.ru/api/shows/character",i);console.log(x.data),l(""),g()},F=async(r,i)=>{if(r.preventDefault(),console.log(n+" "+i),!n)return;const x={personID:n,characterID:i},P=await v.post("https://glagoltheatre.ru/api/shows/performer",x);console.log(P.data),p(""),g()};return o.jsxs(jt,{title:e.name,children:[o.jsx(W,{variant:"body2"}),o.jsxs(G,{title:"Роли",children:[o.jsxs(z,{container:!0,spacing:{xs:0,sm:2},alignItems:"center",children:[o.jsx(z,{size:{xs:12,sm:9},children:o.jsxs($t,{fullWidth:!0,children:[o.jsx(kt,{htmlFor:"txt-character",children:"Новая роль"}),o.jsx(Mt,{id:"txt-character",type:"text",name:"txtCharacter",value:a,onChange:r=>l(r.target.value)})]})}),o.jsx(z,{size:{xs:12,sm:3},children:o.jsx(X,{children:o.jsx(I,{disableElevation:!0,fullWidth:!0,size:"large",type:"button",variant:"contained",color:"secondary",onClick:A,children:"Добавить"})})})]}),o.jsx(It,{data:T()})]})]})}const ne=({item:t,onDelete:e})=>{const[s,a]=c.useState(!1),l=()=>{a(!0)},n=()=>{a(!1)},p=()=>{e(t),n()};return o.jsxs(o.Fragment,{children:[o.jsx(Pt,{title:"Удалить",children:o.jsx(Wt,{"aria-label":"delete",onClick:l,children:o.jsx(At,{})})}),o.jsx(re,{open:s,handleClose:n,handleConfirm:p,title:"Подтверждение удаления",description:"Точно удалить?"})]})};export{ge as default};
